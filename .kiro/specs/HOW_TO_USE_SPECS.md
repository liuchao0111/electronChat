## 什么是 Specs？

Specs（规范）是 Kiro 提供的一种结构化方式，用于规划和实施复杂功能。它将功能开发过程形式化为需求、设计和实施任务三个阶段，让你能够与 AI 助手迭代地完成整个开发流程。

## 三个核心文件

每个 spec 包含三个核心文档：

### 1. requirements.md - 需求文档 📋

**作用**：定义"要做什么"（What）

**内容包括**：
- 用户故事（User Stories）
- 验收标准（Acceptance Criteria）
- 功能需求和非功能需求
- 业务目标和约束条件

**格式示例**：
```markdown
### 需求 1：TypeScript 类型安全

**用户故事**：作为开发者，我希望整个代码库都有严格的 TypeScript 类型安全，
以便在编译时捕获错误并提高代码可靠性。

#### 验收标准

1. 当应用程序编译 TypeScript 代码时，系统应强制执行严格的类型检查
2. 当创建提供商时，系统应根据定义的接口验证配置类型
3. 当读取 localStorage 数据时，系统应在使用前验证数据
```

**何时编写**：
- 项目开始前，明确要实现什么功能
- 与产品经理或团队讨论后
- 需要清晰定义功能边界时

---

### 2. design.md - 设计文档 🏗️

**作用**：定义"如何实现"（How）

**内容包括**：
- 技术架构设计
- 数据结构和数据库模式
- API 接口设计
- 组件/模块设计
- 流程图和时序图
- 技术选型和理由

**格式示例**：
```markdown
## Provider Factory Pattern

**目标**：统一管理多个 AI Provider 的创建和配置

**设计方案**：

\`\`\`typescript
interface ProviderFactory {
  create(type: ProviderType, config: ProviderConfig): AIProvider;
}
\`\`\`

**优势**：
- 集中管理 provider 创建逻辑
- 支持 provider 复用（单例模式）
- 易于添加新的 provider
```

**何时编写**：
- 需求明确后，开始实施前
- 需要做技术决策时
- 需要与团队讨论实现方案时

---

### 3. tasks.md - 任务清单 ✅

**作用**：定义"实施步骤"（Steps）

**内容包括**：
- 具体的开发任务
- 任务优先级和依赖关系
- 任务状态跟踪（未开始、进行中、已完成）
- 预估工作量
- 子任务分解

**格式示例**：
```markdown
### Task 1.1: TypeScript Strict Mode ⬜
**Priority**: High | **Time**: 4h | **Dependencies**: None

启用 TypeScript 严格模式，修复所有类型错误

**Subtasks**:
- [ ] 在 tsconfig.json 中启用 strict: true
- [ ] 修复所有 any 类型
- [ ] 为所有函数添加返回类型
```

**何时编写**：
- 设计方案确定后
- 准备开始实施时
- 需要分配任务给团队成员时

---

## 使用流程

### 方式一：完全手动编写

1. 创建 spec 目录：`.kiro/specs/your-feature-name/`
2. 依次编写三个文件：
   - `requirements.md` - 明确需求
   - `design.md` - 设计方案
   - `tasks.md` - 任务分解

### 方式二：使用 Kiro 辅助生成 ⭐ 推荐

#### 步骤 1：让 Kiro 生成需求文档

```
请为我的 [功能描述] 生成一个 requirements.md 文档，
包含用户故事和验收标准。
```

**示例**：
```
请为"用户设置功能"生成一个 requirements.md 文档，
需要支持主题切换、语言选择、API Key 配置。
```

#### 步骤 2：让 Kiro 生成设计文档

```
基于 requirements.md，请生成 design.md 设计文档，
包含技术架构、数据结构和实现方案。
```

#### 步骤 3：让 Kiro 生成任务清单

```
基于 requirements.md 和 design.md，
请生成 tasks.md 任务清单，按优先级排序。
```

#### 步骤 4：执行任务

```
请按照 tasks.md 中的 Task 1.1 开始实施。
```

---

## 实用技巧

### 1. 引用外部文件

在 spec 文档中可以引用其他文件：

```markdown
参考 API 规范：#[[file:api-spec.yaml]]
参考数据库设计：#[[file:database-schema.sql]]
```

### 2. 迭代式开发

不需要一次性完成所有文档，可以：
1. 先写核心需求
2. 设计核心功能
3. 实施第一个任务
4. 根据反馈调整后续需求和设计

### 3. 任务状态管理

使用 emoji 标记任务状态：
- ⬜ 未开始
- 🟦 进行中
- ✅ 已完成
- ⏸️ 被阻塞
- ❌ 已取消

### 4. 优先级设置

建议使用四级优先级：
- **Critical**（关键）：必须立即完成
- **High**（高）：重要且紧急
- **Medium**（中）：重要但不紧急
- **Low**（低）：可以延后

---

## 实际案例

### 案例：项目优化

**目录结构**：
```
.kiro/specs/project-optimization/
├── requirements.md   # 12 个优化需求
├── design.md         # 7 个设计方案
└── tasks.md          # 23 个具体任务
```

**工作流程**：
1. ✅ 扫描项目，生成优化需求文档
2. ✅ 基于需求，设计技术方案
3. ✅ 分解为具体任务
4. 🟦 按优先级逐个实施任务
5. ⬜ 完成后更新文档

---

## 常见问题

### Q: 必须三个文件都写吗？

A: 不一定。小功能可以只写 tasks.md，复杂功能建议三个都写。

### Q: 可以修改已有的 spec 吗？

A: 当然可以！spec 是活文档，应该随着项目演进不断更新。

### Q: 如何让 Kiro 理解我的 spec？

A: 在对话中提到文件路径，如：
```
请按照 .kiro/specs/project-optimization/tasks.md 
中的 Task 2.1 实施路由懒加载。
```

### Q: spec 文档可以用中文吗？

A: 完全可以！使用你最舒服的语言编写。

---

## 最佳实践

### ✅ 推荐做法

1. **需求先行**：先明确需求，再考虑实现
2. **小步迭代**：将大任务分解为小任务
3. **及时更新**：完成任务后更新状态
4. **记录决策**：在 design.md 中记录技术决策的理由
5. **使用 Kiro**：让 AI 帮你生成和维护文档

### ❌ 避免做法

1. 不要写过于详细的设计（会过时）
2. 不要忽略验收标准（无法验证完成度）
3. 不要让文档与代码脱节（定期同步）
4. 不要一次性规划太多（保持灵活性）

---

## 总结

**Specs 的价值**：
- 📋 **清晰的目标**：知道要做什么
- 🏗️ **明确的方案**：知道如何实现
- ✅ **可追踪的进度**：知道完成了多少
- 🤖 **AI 协作**：让 Kiro 更好地理解你的意图

**记住**：Specs 是工具，不是负担。根据项目规模灵活使用，让它帮助你更高效地开发！
